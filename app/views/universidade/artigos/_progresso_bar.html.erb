<%#
  Locals: trilha, concluidos_ids, artigos (array total da trilha)
  Envolto em <div id="artigo_progresso"> para substituição via Turbo Stream.
%>
<% total    = artigos.size %>
<% concl    = concluidos_ids.size %>
<% pct      = total.positive? ? (concl.to_f / total * 100).round : 0 %>
<% completo = pct == 100 %>

<div class="flex items-center gap-3">
  <div class="flex-1 bg-gray-100 rounded-full h-2">
    <div class="h-2 rounded-full transition-all duration-500 <%= completo ? 'bg-green-500' : 'bg-pink-500' %>"
         style="width: <%= pct %>%"></div>
  </div>
  <span class="text-sm font-medium flex-shrink-0 <%= completo ? 'text-green-600' : 'text-gray-500' %>">
    <%= concl %> / <%= total %> artigo<%= total == 1 ? '' : 's' %>
  </span>
  <% if completo %>
    <%= badge_component(color: :green, size: :xs, shape: :pill) { "Trilha concluída!" } %>
  <% end %>
</div>
